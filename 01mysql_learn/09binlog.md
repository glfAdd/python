##### 是什么

```
redo log 重做日志, 当 mysql 服务异常已提交的事务持久化刀磁盘
```

##### 作用

```



innodb 是以页为单位来管理存储空间的，任何的读写操作最终都会操作完整的一个页，会将整个页加载到buffer pool中，然后对需要修改的记录进行修改，
修改完后，不立即刷新，而是记录一条日志，日志内容就是记录哪个页面，多少偏移量，什么数据发生了什么变更。这样即使系统崩溃，再恢复后，也可以根据redo日志进行数据恢复


redo log是循环写入固定的文件，是顺序写入磁盘的。


在一个事物中，可能会发生多次的数据修改，对应的就是多个数据页多个偏移量位置的字段变更，也就是说会产生多条redo log，而且因为在同一个事物中，这些redo log，也是不可再分的，也就是说，一个组的redo log在持久化的时候，不能部分成功，部分失败，否则的话，就会破坏事务的原子性。
另外为了提升性能redo log是按照块组织在一起，然后写入到磁盘中的，类似于数据的页，而且引入了redo log buffer，默认的大小为16MB。buffer中分了很多的block，每个block的大小为512kb，每一个事务产生的所有redo log称为一个group。



redo log 开始时在内存中, 需要写到磁盘中

```

##### redo log 刷盘时机

```
通过 innodb_flush_log_at_trx_commit 控制 redo log 的刷盘时机
	1. commit的时候进行刷盘：这也是最保险的，因为如果这个时候崩溃了代表没有commit成功，因此，也不用恢复什么数据。
	2. commit的时候，只是刷新近os的内核缓冲区，具体的刷盘时机不确定。
	0. 后台线程，每s刷新一次到磁盘中。

为了保证事务的持久性，推荐使用1.
```

```

```

